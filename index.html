<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Bad-Budgetrechner | Powered by OSION Solution XR</title>

  <style>
    :root{
      --osion-red:#b11217;
      --osion-red-dark:#8f0f14;
      --ink:#0b0b0f;
      --muted:#6b7280;
      --bg:#07070b;
      --shadow: 0 26px 80px rgba(0,0,0,.48);
      --radius: 22px;

      /* wird per JS gesetzt */
      --hero-bg: none;
    }

    *{box-sizing:border-box}
    html,body{height:100%}

    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
      color: #eef2ff;
      background:
        radial-gradient(1100px 560px at 20% -10%, rgba(177,18,23,.22), transparent 60%),
        radial-gradient(900px 520px at 95% 0%, rgba(143,15,20,.20), transparent 55%),
        radial-gradient(900px 520px at 50% 110%, rgba(255,255,255,.07), transparent 55%),
        var(--bg);
    }

    /* Box größer + weniger Rand */
    .wrap{max-width:1240px;margin:22px auto;padding:0 16px;}

    .shell{
      border-radius: var(--radius);
      overflow:hidden;
      box-shadow: var(--shadow);
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.06);
      backdrop-filter: blur(10px);
    }

    /* Header höher, damit Logo/Background nicht abgeschnitten wird */
    .hero{
      position:relative;
      height: 300px;
      background:#111;
      background-image: var(--hero-bg);
      background-size: cover;
      background-position: center 18%;
    }

    .hero::before{
      content:"";
      position:absolute; inset:0;
      background:
        linear-gradient(90deg, rgba(0,0,0,.78) 0%, rgba(0,0,0,.35) 58%, rgba(0,0,0,.70) 100%),
        radial-gradient(620px 280px at 18% 34%, rgba(177,18,23,.30), transparent 65%),
        radial-gradient(520px 240px at 78% 28%, rgba(143,15,20,.22), transparent 62%);
      pointer-events:none;
    }

    .hero::after{
      content:"";
      position:absolute; inset:0;
      background: linear-gradient(180deg, transparent 52%, rgba(0,0,0,.45) 100%);
      pointer-events:none;
    }

    .hero-inner{
      position:relative;
      height:100%;
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      gap: 14px;
      padding: 30px 26px;
      z-index:1;
    }

    .left{
      display:flex;
      gap:14px;
      align-items:flex-end;
      max-width: 820px;
      min-width: 0;
    }

    .logo{
      width:64px;
      height:64px;
      border-radius:16px;
      background: rgba(255,255,255,.10);
      border: 1px solid rgba(255,255,255,.18);
      backdrop-filter: blur(10px);
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
      flex: 0 0 auto;
      box-shadow: 0 18px 40px rgba(0,0,0,.35);
    }
    .logo img{
      width: 52px;
      height: 52px;
      object-fit: contain;
      display:block;
      filter: drop-shadow(0 10px 18px rgba(0,0,0,.35));
    }

    .brand{display:flex;flex-direction:column;gap:7px;line-height:1.05;min-width:0;}
    .kicker{font-size:12px;letter-spacing:.16em;text-transform:uppercase;opacity:.92;}
    .title{font-size:30px;font-weight:950;letter-spacing:-.03em;text-shadow:0 12px 30px rgba(0,0,0,.55);}

    .badge{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding: 10px 12px;
      border-radius: 999px;
      background: rgba(255,255,255,.10);
      border: 1px solid rgba(255,255,255,.18);
      backdrop-filter: blur(10px);
      color:#fff;
      font-weight:850;
      font-size:12px;
      white-space:nowrap;
    }
    .dot{
      width:10px;height:10px;border-radius:50%;
      background: linear-gradient(135deg, var(--osion-red-dark), var(--osion-red));
      box-shadow: 0 0 0 6px rgba(177,18,23,.15);
    }

    .content{padding:18px 22px;background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));}

    .toprow{
      display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap;
      margin-bottom:14px;
    }
    .hint{color:rgba(255,255,255,.78);font-size:13px;}
    .progress{width:340px;height:10px;background:rgba(255,255,255,.08);border-radius:999px;overflow:hidden;border:1px solid rgba(255,255,255,.14);}
    .bar{
      height:100%;
      width:0%;
      background: linear-gradient(90deg, #000 0%, var(--osion-red-dark) 58%, var(--osion-red) 100%);
      transition: width .25s ease;
    }

    .panel{
      margin-top:12px;
      border-radius:18px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.12);
      padding:16px;
    }

    .question{
      font-size:16px;
      font-weight:950;
      margin:2px 0 14px 0;
      letter-spacing:-.01em;
      display:flex;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
    }
    .infoDot{
      width:18px;height:18px;border-radius:999px;
      display:inline-flex;align-items:center;justify-content:center;
      font-size:12px;font-weight:900;
      color:rgba(255,255,255,.85);
      background:rgba(255,255,255,.10);
      border:1px solid rgba(255,255,255,.18);
    }

    .grid{display:grid;grid-template-columns: repeat(2, minmax(0,1fr));gap:14px;}
    .grid.cols-3{grid-template-columns: repeat(3, minmax(0,1fr))}
    .grid.cols-4{grid-template-columns: repeat(4, minmax(0,1fr))}
    @media (max-width: 980px){
      .grid.cols-4{grid-template-columns: repeat(2, minmax(0,1fr))}
    }
    @media (max-width: 900px){
      .grid.cols-3{grid-template-columns:1fr}
    }
    @media (max-width: 760px){
      .grid{grid-template-columns:1fr}
      .progress{width:100%}
      .hero{height: 240px}
      .title{font-size:24px}
    }

    .opt{
      border-radius: 18px;
      padding: 16px;
      background: rgba(255,255,255,.92);
      color: #0b0b0f;
      border: 2px solid rgba(0,0,0,.06);
      cursor:pointer;
      transition: transform .12s ease, border-color .12s ease, box-shadow .12s ease;
      min-height: 118px;
      display:flex;
      flex-direction:row;
      align-items:center;
      gap:14px;
      user-select:none;
      position:relative;
      overflow:hidden;
    }
    .opt::before{
      content:"";
      position:absolute; inset:-2px;
      background: radial-gradient(340px 190px at 25% 0%, rgba(177,18,23,.18), transparent 55%);
      opacity:0;
      transition: opacity .16s ease;
      pointer-events:none;
    }
    .opt:hover{transform: translateY(-1px);box-shadow: 0 18px 40px rgba(0,0,0,.18);}
    .opt:hover::before{opacity:1}

    .opt.active{
      border-color: rgba(177,18,23,.90);
      box-shadow: 0 22px 52px rgba(177,18,23,.22);
    }

    .iconBox{
      width:56px;height:56px;border-radius:16px;
      display:flex;align-items:center;justify-content:center;
      background: rgba(15,15,20,.92);
      color:#fff;
      flex:0 0 auto;
      border:1px solid rgba(0,0,0,.15);
    }
    .opt.active .iconBox{
      background: linear-gradient(135deg, var(--osion-red-dark), var(--osion-red));
    }

    .optText{display:flex;flex-direction:column;gap:6px;min-width:0;}
    .opt .label{font-weight:950;letter-spacing:-.01em;font-size:14px;}
    .opt .sub{color: rgba(11,11,15,.70);font-size:12px;line-height:1.25;}

    .nav{
      display:flex;justify-content:space-between;align-items:center;gap:12px;
      margin-top:16px;padding-top:14px;border-top:1px solid rgba(255,255,255,.10);
    }
    .btn{
      border:0;padding:11px 14px;border-radius:14px;
      font-weight:900;cursor:pointer;
    }
    .btn.back{
      background: rgba(255,255,255,.12);
      border: 1px solid rgba(255,255,255,.16);
      color:#fff;
      backdrop-filter: blur(10px);
    }
    .btn.back:disabled{opacity:.35;cursor:not-allowed}
    .stepHint{color: rgba(255,255,255,.70);font-size: 12px;}

    .result{
      border-radius: 18px;
      background: rgba(255,255,255,.92);
      color:#0b0b0f;
      border: 1px solid rgba(0,0,0,.08);
      padding: 16px;
    }
    .result h3{margin:0 0 10px 0;font-weight:950}
    .result p{margin:0 0 12px 0;color:rgba(11,11,15,.70);font-size:13px;line-height:1.35}

    .rows{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      margin-top:10px;
    }
    @media (max-width: 760px){ .rows{grid-template-columns:1fr} }

    .row{
      background: rgba(255,255,255,.86);
      border: 1px solid rgba(0,0,0,.08);
      border-radius: 14px;
      padding: 10px 12px;
      display:flex;
      justify-content:space-between;
      gap: 10px;
      font-size: 13px;
    }
    .total{
      margin-top:12px;
      font-size:18px;
      font-weight:950;
      display:flex;
      justify-content:flex-end;
    }

    .cta{
      margin-top:12px;
      display:flex;
      justify-content:flex-end;
      gap:10px;
      flex-wrap:wrap;
    }
    .cta a{
      text-decoration:none;
      display:inline-block;
      padding:11px 14px;
      border-radius:14px;
      font-weight:950;
      font-size:13px;
    }
    .cta .primary{
      background: linear-gradient(135deg, var(--osion-red-dark), var(--osion-red));
      color:#fff;
      box-shadow: 0 18px 40px rgba(177,18,23,.25);
    }
    .cta .ghost{
      background: rgba(15,15,20,.92);
      color:#fff;
      border:1px solid rgba(255,255,255,.10);
    }

    .footer{
      padding:0 22px 18px 22px;
      color: rgba(255,255,255,.65);
      font-size: 12px;
      text-align:center;
    }

    /* kleine SVGs */
    svg{display:block}
  </style>
</head>

<body>
  <div class="wrap">
    <div class="shell" id="shell">

      <div class="hero">
        <div class="hero-inner">
          <div class="left">
            <div class="logo">
              <img id="osionLogo" alt="OSION Solution XR" />
            </div>
            <div class="brand">
              <div class="kicker">Powered by OSION Solution XR</div>
              <div class="title">Interaktiver Bad-Budgetrechner</div>
            </div>
          </div>
          <div class="badge"><span class="dot"></span><span>Unverbindlich</span></div>
        </div>
      </div>

      <div class="content">
        <div class="toprow">
          <div class="hint">Unverbindliche Kostenschätzung auf Basis der Auswahl.</div>
          <div class="progress"><div class="bar" id="bar"></div></div>
        </div>

        <div class="panel">
          <div id="app"></div>

          <div class="nav">
            <button class="btn back" id="backBtn" type="button">Zurück</button>
            <div class="stepHint" id="stepHint"></div>
          </div>
        </div>
      </div>

      <div class="footer">
        © OSION Solution XR – Unverbindliche Kostenschätzung. Keine Preisgarantie.
      </div>
    </div>
  </div>

<script>
(() => {
  // =========================
  // ASSETS / LINKS (HIER anpassen)
  // =========================
  const OSION_LOGO_FILE = "MGU-0015%20Logo%20OSION%20Solution%20XR.png";
  const HEADER_BG_FILE  = OSION_LOGO_FILE;     // du kannst später hier ein eigenes Headerbild einsetzen
  const CONTACT_URL     = "";                  // z.B. "https://kunde.de/kontakt"

  document.getElementById("shell").style.setProperty("--hero-bg", `url("${HEADER_BG_FILE}")`);
  document.getElementById("osionLogo").src = OSION_LOGO_FILE;

  // =========================
  // PREISE / GEWICHTUNG (alle 7 Variablen wirken auf den Preis)
  // =========================
  const VAT = 0.19;

  // Basispreise (NETTO) nach Grundfläche – als realistische Orientierungswerte
  // Diese Basis gilt für: Eigentümer + Sanierung + 2 Personen + Komfort + Dusche + 3–6 Monate
  const baseByAreaNet = {
    "4-5 qm": 15000,
    "5-7 qm": 18500,
    "7-10 qm": 23500,
    ">10 qm": 29500
  };

  // Faktoren pro Schritt (Multiplikatoren)
  const factors = {
    ownership: { "Eigentümer": 1.00, "Mieter": 1.03 },                 // Koordination/Abstimmung
    project:   { "Sanierung": 1.00, "Neubau": 0.93 },                  // kein Rückbau/Entsorgung
    people:    { "1 Person": 0.97, "2 Personen": 1.00, "3 Personen": 1.06, "4 Personen": 1.12 },
    quality:   { "Basic": 0.88, "Komfort": 1.00, "Luxus": 1.28 },
    area:      { "4-5 qm": 1.00, "5-7 qm": 1.00, "7-10 qm": 1.00, ">10 qm": 1.00 }, // Basis steckt schon in baseByAreaNet
    tub:       { "Dusche": 1.00, "Badewanne": 1.06, "Dusche und Badewanne": 1.14 },
    timing:    { "1-3 Monate": 1.06, "3-6 Monate": 1.00, "Später": 0.98 }
  };

  // Aufteilung der Netto-Summe auf Gewerke (Summe = 1.00)
  const breakdownWeights = {
    "Demontage / Montage / Installation im Bad": 0.36,
    "Malerarbeiten im Bad": 0.05,
    "Ausstattung im Bad": 0.33,
    "Fliesenarbeiten / Fliesen im Bad": 0.18,
    "Elektroarbeiten im Bad": 0.08
  };

  // =========================
  // STEPS (1–7 Auswahl, 8 Ergebnis)
  // =========================
  const steps = [
    {
      key: "ownership",
      question: "Sind Sie Eigentümer oder Mieter?",
      cols: 2,
      options: [
        { label: "Eigentümer", sub: "Direkte Entscheidung möglich", icon: "home" },
        { label: "Mieter", sub: "Abstimmung mit Vermieter nötig", icon: "tenant" }
      ]
    },
    {
      key: "project",
      question: "Planen Sie eine Badezimmersanierung oder einen Neubau?",
      cols: 2,
      options: [
        { label: "Sanierung", sub: "Bestehendes Bad modernisieren", icon: "reno" },
        { label: "Neubau", sub: "Bad neu erstellen", icon: "build" }
      ]
    },
    {
      key: "people",
      question: "Wieviele Personen leben im Haushalt?",
      cols: 4,
      options: [
        { label: "1 Person", sub: "Kompakter Bedarf", icon: "p1" },
        { label: "2 Personen", sub: "Typischer Bedarf", icon: "p2" },
        { label: "3 Personen", sub: "Mehr Nutzung", icon: "p3" },
        { label: "4 Personen", sub: "Hohe Nutzung", icon: "p4" }
      ]
    },
    {
      key: "quality",
      question: "In welcher Qualität soll Ihr Bad ausgestattet werden?",
      cols: 3,
      options: [
        { label: "Basic", sub: "Preisbewusst & solide", icon: "basic" },
        { label: "Komfort", sub: "Mittelklasse / Standard", icon: "comfort" },
        { label: "Luxus", sub: "Hochwertig & Premium", icon: "lux" }
      ]
    },
    {
      key: "area",
      question: "Wie groß ist die Grundfläche Ihres Bades?",
      cols: 4,
      options: [
        { label: "4-5 qm", sub: "Kompakt", icon: "m2" },
        { label: "5-7 qm", sub: "Standard", icon: "m2" },
        { label: "7-10 qm", sub: "Komfort", icon: "m2" },
        { label: ">10 qm", sub: "Groß", icon: "m2" }
      ]
    },
    {
      key: "tub",
      question: "Möchten Sie Ihr Badezimmer mit einer Dusche und/oder einer Badewanne ausstatten?",
      cols: 3,
      options: [
        { label: "Dusche", sub: "Modern & effizient", icon: "shower" },
        { label: "Badewanne", sub: "Komfort & Entspannung", icon: "tub" },
        { label: "Dusche und Badewanne", sub: "Maximale Flexibilität", icon: "both" }
      ]
    },
    {
      key: "timing",
      question: "Zeitpunkt der Ausführung?",
      cols: 3,
      options: [
        { label: "1-3 Monate", sub: "Zeitnah", icon: "fast" },
        { label: "3-6 Monate", sub: "Geplant", icon: "mid" },
        { label: "Später", sub: "Ohne Zeitdruck", icon: "late" }
      ]
    },
    { key: "result" }
  ];

  // STATE
  const state = {
    ownership: null,
    project: null,
    people: null,
    quality: null,
    area: null,
    tub: null,
    timing: null
  };
  let idx = 0;

  // DOM
  const app = document.getElementById("app");
  const bar = document.getElementById("bar");
  const backBtn = document.getElementById("backBtn");
  const stepHint = document.getElementById("stepHint");

  function formatEUR(v){
    return v.toLocaleString("de-DE", { style:"currency", currency:"EUR" });
  }

  function computeNet(){
    const base = baseByAreaNet[state.area] ?? 0;

    const f =
      (factors.ownership[state.ownership] ?? 1) *
      (factors.project[state.project] ?? 1) *
      (factors.people[state.people] ?? 1) *
      (factors.quality[state.quality] ?? 1) *
      (factors.tub[state.tub] ?? 1) *
      (factors.timing[state.timing] ?? 1);

    return Math.round(base * f);
  }

  function breakdown(net){
    const out = {};
    for (const [k,w] of Object.entries(breakdownWeights)){
      out[k] = Math.round(net * w);
    }
    return out;
  }

  function setProgress(){
    const stepsCount = steps.length - 1; // ohne result
    const current = Math.min(idx, stepsCount);
    const p = Math.round((current / stepsCount) * 100);
    bar.style.width = p + "%";
  }

  function iconSvg(name){
    // minimalistische Inline-SVGs (keine Extra-Assets nötig)
    const common = 'width="26" height="26" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"';
    switch(name){
      case "home":
        return `<svg ${common}><path d="M3 10.5 12 3l9 7.5"/><path d="M5 9.5V21h14V9.5"/></svg>`;
      case "tenant":
        return `<svg ${common}><path d="M16 20v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="3"/><path d="M19 8l2 2-4 4-2 .5.5-2z"/></svg>`;
      case "reno":
        return `<svg ${common}><path d="M3 21h18"/><path d="M7 20v-9l5-4 5 4v9"/><path d="M9 20v-4h6v4"/></svg>`;
      case "build":
        return `<svg ${common}><path d="M3 21h18"/><path d="M6 21V8h8v13"/><path d="M14 12h4l1 9h-5"/><path d="M10 8V4h3v4"/></svg>`;
      case "p1":
        return `<svg ${common}><circle cx="12" cy="7" r="3"/><path d="M5 21v-2a7 7 0 0 1 14 0v2"/></svg>`;
      case "p2":
        return `<svg ${common}><circle cx="8" cy="8" r="3"/><circle cx="16" cy="8" r="3"/><path d="M2 21v-2a6 6 0 0 1 12 0v2"/><path d="M10 21v-2a6 6 0 0 1 12 0v2"/></svg>`;
      case "p3":
        return `<svg ${common}><circle cx="12" cy="7" r="3"/><circle cx="6" cy="9" r="2"/><circle cx="18" cy="9" r="2"/><path d="M4 21v-2a6 6 0 0 1 16 0v2"/><path d="M2 21v-1a4 4 0 0 1 7-3"/><path d="M22 21v-1a4 4 0 0 0-7-3"/></svg>`;
      case "p4":
        return `<svg ${common}><circle cx="8" cy="8" r="2"/><circle cx="16" cy="8" r="2"/><circle cx="12" cy="7" r="3"/><path d="M3 21v-1a5 5 0 0 1 9-3"/><path d="M21 21v-1a5 5 0 0 0-9-3"/><path d="M5 21v-2a6 6 0 0 1 14 0v2"/></svg>`;
      case "basic":
        return `<svg ${common}><circle cx="12" cy="12" r="8"/><path d="M8 12h8"/><path d="M12 8v8"/></svg>`;
      case "comfort":
        return `<svg ${common}><path d="M12 2l2.2 5.5L20 8l-4 4 .9 6-4.9-2.8L7.1 18 8 12 4 8l5.8-.5z"/></svg>`;
      case "lux":
        return `<svg ${common}><path d="M12 2l4 6-4 14-4-14z"/><path d="M8 8h8"/></svg>`;
      case "m2":
        return `<svg ${common}><path d="M4 4h6"/><path d="M4 4v6"/><path d="M20 4h-6"/><path d="M20 4v6"/><path d="M4 20h6"/><path d="M4 20v-6"/><path d="M20 20h-6"/><path d="M20 20v-6"/></svg>`;
      case "shower":
        return `<svg ${common}><path d="M4 10h16"/><path d="M7 10V6a3 3 0 0 1 3-3h7"/><path d="M16 10v2"/><path d="M8 14v2"/><path d="M12 14v2"/><path d="M16 14v2"/></svg>`;
      case "tub":
        return `<svg ${common}><path d="M3 12h18"/><path d="M5 12v3a4 4 0 0 0 4 4h6a4 4 0 0 0 4-4v-3"/><path d="M7 19v2"/><path d="M17 19v2"/><path d="M7 8h5a2 2 0 0 1 2 2v2"/></svg>`;
      case "both":
        return `<svg ${common}><path d="M3 12h18"/><path d="M5 12v3a4 4 0 0 0 4 4h6a4 4 0 0 0 4-4v-3"/><path d="M7 19v2"/><path d="M17 19v2"/><path d="M4 8h6"/><path d="M7 8V5"/><path d="M14 7h6"/><path d="M17 7v3"/></svg>`;
      case "fast":
        return `<svg ${common}><circle cx="12" cy="12" r="8"/><path d="M12 8v5l3 2"/><path d="M4 12h2"/><path d="M18 12h2"/></svg>`;
      case "mid":
        return `<svg ${common}><circle cx="12" cy="12" r="8"/><path d="M12 7v6"/><path d="M12 13h4"/></svg>`;
      case "late":
        return `<svg ${common}><circle cx="12" cy="12" r="8"/><path d="M12 6v6"/><path d="M12 12l-3 3"/></svg>`;
      default:
        return `<svg ${common}><circle cx="12" cy="12" r="8"/></svg>`;
    }
  }

  function render(){
    setProgress();

    backBtn.disabled = idx === 0;
    const maxSteps = steps.length - 1; // ohne Ergebnis
    stepHint.textContent = idx < maxSteps ? `Schritt ${idx+1} von ${maxSteps}` : "";

    const s = steps[idx];

    if (s.key === "result"){
      const net = computeNet();
      const vat = Math.round(net * VAT);
      const gross = net + vat;
      const parts = breakdown(net);

      const summary =
`Bad-Kalkulation (unverbindlich)

Eigentümer/Mieter: ${state.ownership}
Projekt: ${state.project}
Haushalt: ${state.people}
Qualität: ${state.quality}
Grundfläche: ${state.area}
Dusche/Badewanne: ${state.tub}
Zeitpunkt: ${state.timing}

Summe (netto): ${formatEUR(net)}
MwSt.: ${formatEUR(vat)}
Summe (brutto): ${formatEUR(gross)}
`;

      const mailHref =
        "mailto:?subject=" + encodeURIComponent("Bad-Kalkulation (unverbindlich)") +
        "&body=" + encodeURIComponent(summary);

      app.innerHTML = `
        <div class="result">
          <h3>Preisinformation</h3>
          <p>
            Für die gewünschte Badausstattung können ungefähr folgende Kosten eingeplant werden.
            Der Gesamtpreis setzt sich anteilig aus Material- und Arbeitskosten zusammen.
          </p>

          <div class="rows">
            ${Object.entries(parts).map(([k,v]) => `
              <div class="row"><div>${k}</div><div><b>${formatEUR(v)}</b></div></div>
            `).join("")}
            <div class="row"><div>MwSt.</div><div><b>${formatEUR(vat)}</b></div></div>
          </div>

          <div class="total">Summe Total (mit MwSt.): ${formatEUR(gross)}</div>

          <div class="cta">
            <a class="ghost" href="${mailHref}">Ergebnis per E-Mail</a>
            <a class="ghost" href="#" id="copyBtn">Ergebnis kopieren</a>
            ${CONTACT_URL ? `<a class="primary" href="${CONTACT_URL}" target="_blank" rel="noopener">Zum Kontaktformular</a>` : ``}
          </div>
        </div>
      `;

      document.getElementById("copyBtn").addEventListener("click", async (e) => {
        e.preventDefault();
        try{
          await navigator.clipboard.writeText(summary);
          alert("Ergebnis kopiert.");
        }catch{
          alert("Kopieren nicht möglich. Bitte manuell übernehmen.");
        }
      });

      return;
    }

    const gridClass =
      s.cols === 4 ? "grid cols-4" :
      s.cols === 3 ? "grid cols-3" : "grid";

    app.innerHTML = `
      <div class="question">
        ${s.question}
        <span class="infoDot" title="Auswahl beeinflusst die Kostenschätzung">i</span>
      </div>

      <div class="${gridClass}">
        ${s.options.map(opt => {
          const active = state[s.key] === opt.label ? "active" : "";
          return `
            <div class="opt ${active}" data-val="${opt.label}" role="button" tabindex="0">
              <div class="iconBox">${iconSvg(opt.icon)}</div>
              <div class="optText">
                <div class="label">${opt.label}</div>
                <div class="sub">${opt.sub || ""}</div>
              </div>
            </div>
          `;
        }).join("")}
      </div>
    `;

    function pick(val){
      state[s.key] = val;
      app.querySelectorAll(".opt").forEach(el => el.classList.toggle("active", el.dataset.val === val));

      // Auto-Weiter
      window.setTimeout(() => {
        idx = Math.min(idx + 1, steps.length - 1);
        render();
      }, 140);
    }

    app.querySelectorAll(".opt").forEach(el => {
      el.addEventListener("click", () => pick(el.dataset.val));
      el.addEventListener("keydown", (e) => {
        if (e.key === "Enter" || e.key === " ") {
          e.preventDefault();
          pick(el.dataset.val);
        }
      });
    });
  }

  backBtn.addEventListener("click", () => {
    idx = Math.max(idx - 1, 0);
    render();
  });

  render();
})();
</script>
</body>
</html>
